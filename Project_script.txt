안녕하세요 이번에 카트라이더 open api를 이용한 메타변화 분석을 진행한 ai 11기 박성우라고합니다.

진행은 데이터를 선정하고 문제를 정의한 후 이에 맞는 머신러닝을 적용하여 예측하고 해석하는 과정으로 진행됩니다.

우선 주제를 선정한 동기는 다음과 같습니다. 현재 카트라이더에는 일반,레어,레전드,유니크 등급의 카트가 있습니다. 그리고 현재 최신 엔진인 v1엔진에서 레전드 카트가 나왔죠. 이 카트의 성능이 오버밸런스라는 점에서 문제가 되기도 하고 카트를 분해하면 나오는 파츠들의 영향력이 크다는 지적도 있습니다. 저는 이 상황에 대한 메타변화를 확인하기 위해서 주제를 진행했습니다.

문제 해결과정은 다음과 같습니다. 순위를 예측하는 분류모델을 설계하고 순위에 영향을 준 요소들의 중요도를 파악한 다음, 인사이트를 도출해내는 것입니다.
우선 프로젝트는 2개로 진행됩니다. v1엔진 레전드카트가 출시되기 이전과 이후로 나뉘어집니다. 비슷한 유저수를 추출하기 위해서 기간을 동일하게 정해놓고 매치정보를 추출했습니다. 매치참여 유저수가 유사한 것을 볼 수 있습니다.

제가 이용한 open api는 다음과 같은 형태를 띄고있었습니다. 우선 매치리스트를 조회하면 식별자와 게임유형이 나옵니다. 이렇게 추출한 데이터를 바탕으로 다시한번 api를 이용하여 매치상세정보를 조회합니다. 이를 통해서 매치관련정보와 플레이어 관련정보를 얻을 수 있는데요. 이 플레이어 정보를 다시 세부적으로 정리합니다. 그렇게 매치세부정보와 플레이어세부정보를 얻을 수 있었습니다.

가설의 경우에는 레전드카트 출시 이후에 카트와 파츠의 영향력이 올라갔을 것이라고 예측했습니다. 순위 예측모델이므로 순위를 나타내는 matchrank를 예측하겠습니다. 불균형한데이터와 다중분류에 알맞은 f1-score라는 단위를 사용하겠습니다. f1-score는 0부터 1사이의 값으로 나타나며 높을수록 성능이 좋습니다. 가장 간단한 모델인 베이스라인을 최빈값 예측모델로 설정해 모델이 성능을 제대로 발휘하는지 확인하겠습니다. 오른쪽 그래프를 보시면 최빈값이 1위입니다. 따라서 베이스라인 모델은 모든값을 1위로 예측합니다.

다음은 필요한 데이터를 적절히 선택하기위한 전처리 과정입니다. 중복값을 제거하고, 게임에 영향을 주지않는 고유식별자, 캐릭터등을 제거하였습니다. 또한 예측하겠다고 정한 rank에 직접적인 영향을 주는 win,time과 같은 요소들도 제거했습니다.

데이터에서 빈칸으로 나와있는 결측치를 처리한 것들입니다. 가져온 데이터 자체에서 공백인 경우에는 소량이기에 drop 시켰고 미장착한 경우에는 non이라는 값을, 특정버전 이상은 아직 api에서 업데이트 되지 않았기에 오버버젼이라는 값을 주었습니다.

우선 아까 언급한 기준모델들은 0.2105,0.2078의 f1-score를 가졌습니다. 그리고 훈련을 위한 train과 test를 7대3의 비율로 임의로 나누었습니다.

시도한 모델은 랜덤포레스트,캣부스트,xgb를 이용했습니다.
위의 3개의 모델 모두 불균형 데이터를 조정할 수 있는 옵션을 지원하기에 선택하였습니다.

우선 랜덤포레스트 모델입니다. RandomSearchCV라는 함수를 통해서 하이퍼파라미터를 조정했습니다. 이를 통해 레전트카트 출시 이전에는 0.2897 이후에는 0.2838의 f1-score를 얻을 수 있었습니다. 이는 기준모델보다 상대적으로 높은 값입니다. 하지만 아직 많이 낮은 값을 보입니다.

두번째로 사용한 캣부스트 모델입니다. 하이퍼파라미터 조정은 앞과 같습니다. 이를 통해 레전드카트 출시이전에는 0.3540, 이후에는 0.3701의 f1값을 얻었습니다.

세번째로 사용한 XGBClassifier는 모델 자체에서는 이진분류에 대한 가중치만 가능하기에 따로 class_weight라이브러리를 사용해서 임의로 가중치를 부여했습니다. 레전드카트 출시이전에는 0.2767, 이후에는 0.2931의 f1값을 얻었습니다.

결과적으로 모든 모델들이 기준모델보다 성능이 향상된 것을 볼 수 있었고 캣부스트모델이 가장 성능이 좋았기에 이로 진행하도록 하겠습니다.
캣부스트 모델의 교차검증 결과는 다음과 같습니다. 전체적으로 비슷한 값을 보이는데요 이는 모델의 복잡도에 비해 샘플의 수가 충분히 많다는 것을 의미합니다.

다음 그래프는 레전트카트 출시 이전 이후들의 요소들의 중요도를 보여줍니다. 트랙,카트,라이센스의 영향이 전체적으로 큰데요. 여기서 하나 의외의 결과를 보여줍니다. 일반모드만 나타내는 channelname의 경우에는 동일하지만 일반모드와 특수모드를 모두 포함하는 matchtype의 경우에는 급격히 중요도가 높아졌습니다. 제가 가설로 세운 파츠부분은 소량 상승하긴 했지만 큰 폭으로 오르진 않았네요.

저희는 이를 통해서 v1엔진의 레전드카트의 출시는 특수모드의 승률에 영향을 준 것을 알 수 있습니다. 제가 가설로세운 파츠부분은 상승하긴 했지만 확정짓기엔 요소의 크기가 작아 확신할 순 없을 것 같습니다.

다음은 프로젝트에 대한 피드백입니다. 저는 파츠들이 제대로 영향력을 보여주지 못한 부분은 x엔진 이상버전의 파츠들이 nan처리 되어있다보니, 파츠들의 특성을 제대로 보여주지 못한 것 같다고 생각합니다. 이는 넥슨자체에서 업데이트를 하지 않았기에 어쩔수 없는 부분이었네요. 다음으로는 전체적인 f1-score가 낮게나왔다는 것입니다. matchtime을 제거하기 전에는 나쁘지않은 score를 보였지만 이는 직접적인 영향을 준다고 판단하여 제거, 이는 수치의 하락으로 이어졌습니다. 하지만 이는 제대로 한 행동이라고 생각합니다. 그 외 아쉬운 점으로는 데이터 추출, 모델 적용에 시간이 많이 소요되어 제한된 시간이라는 특성때문에 더 많은 내용을 다루지 못한 것입니다. 하지만 자체적으로 데이터셋을 만들었다는 점에서 좋은 경험이 된 것 같습니다.

제 발표는 여기까지입니다. 발표자료에 저의 진행과정과 readme가 담긴 깃허브링크가 있습니다. 관심있으신 분들은 한번 방문해주시면 좋을 것 같습니다.
감사합니다.
